---
alwaysApply: true
---
- 함수로직은 건들이지 않고 디자인만 변경 및 수정합니다.
- 사용자가 정의해 놓은 함수로직은 건들이지 않고 로직에 맞는 porps를 사용해서 디자인합니다.
- 함수로직을 수정해야 하는 경우, 어떤 함수를 어떻게 왜 수정해야 하는 지 사용자에게 설명하고 질문을 합니다.
- 항상 사용자가 첨부한 API명세서를 확인하면서 작업합니다.
- API명세서의 내용이 부족하거나, 맞지 않는 경우 사용자에게 상황을 섦명하고 질문합니다.
- 사용자가 정의한 로직은 절대로 마음대로 수정하지 않습니다.

# API 명세서
## 1. Auth (인증)

**Base URL:** `/auth`

### 1.1 로그인
- **Method:** `POST`
- **Endpoint:** `/auth/login`
- **설명:** 이메일과 비밀번호로 로그인
- **인증:** 불필요
- **Request Body:**
  ```json
  {
    "email": "string",
    "password": "string"
  }
  ```
- **Response:** `200 OK`
  ```json
  {
    "message": "Login successful",
    "user": {
      "id": "string",
      "email": "string"
    }
  }
  ```
- **파일 위치:** `src/domain/auth/auth.controller.ts:25`

### 1.2 회원가입
- **Method:** `POST`
- **Endpoint:** `/auth/signup`
- **설명:** 새로운 사용자 회원가입
- **인증:** 불필요
- **Response:** `201 Created`
- **파일 위치:** `src/domain/auth/auth.controller.ts:48`

### 1.3 로그아웃
- **Method:** `POST`
- **Endpoint:** `/auth/logout`
- **설명:** 로그아웃 (쿠키 삭제)
- **인증:** JWT 필수
- **Response:** `200 OK`
  ```json
  {
    "message": "Logout successful"
  }
  ```
- **파일 위치:** `src/domain/auth/auth.controller.ts:56`

---

## 2. Post Participation (게시글 참여)

**Base URL:** `/posts/:postId/participations`

### 2.1 참여 요청
- **Method:** `POST`
- **Endpoint:** `/posts/:postId/participations`
- **설명:** 게시글에 참여 신청
- **인증:** JWT 필수
- **Response:** `201 Created`
- **파일 위치:** `src/domain/post-participation/post-participation.controller.ts:26`

### 2.2 참여자 목록 조회
- **Method:** `GET`
- **Endpoint:** `/posts/:postId/participations`
- **설명:** 특정 게시글의 모든 참여자 목록 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post-participation/post-participation.controller.ts:40`

### 2.3 참여 상태 업데이트
- **Method:** `PATCH`
- **Endpoint:** `/posts/:postId/participations/:participationId`
- **설명:** 참여 신청 승인/거절 (작성자만 가능)
- **인증:** JWT 필수
- **Request Body:**
  ```json
  {
    "status": "approved | rejected"
  }
  ```
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post-participation/post-participation.controller.ts:48`

---

## 3. Binary Content (파일 관리)

**Base URL:** `/binary-content`

### 3.1 업로드용 Presigned URL 발급
- **Method:** `POST`
- **Endpoint:** `/binary-content/presigned-url`
- **설명:** S3에 파일 업로드를 위한 presigned URL 발급
- **인증:** JWT 필수
- **Request Body:**
  ```json
  {
    "fileName": "string",
    "fileType": "string"
  }
  ```
- **Response:** `200 OK`
- **파일 위치:** `src/domain/binary-content/binary-content.controller.ts:34`

### 3.2 파일 접근용 Presigned URL 발급
- **Method:** `GET`
- **Endpoint:** `/binary-content/:id/presigned-url`
- **설명:** S3 파일 접근을 위한 presigned URL 발급
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/binary-content/binary-content.controller.ts:61`

### 3.3 파일 삭제
- **Method:** `DELETE`
- **Endpoint:** `/binary-content/:id`
- **설명:** S3 및 DB에서 파일 삭제
- **인증:** 불필요
- **Response:** `204 No Content`
- **파일 위치:** `src/domain/binary-content/binary-content.controller.ts:70`

---

## 4. Notifications (알림)

**Base URL:** `/notifications`

### 4.1 실시간 알림 구독 (SSE)
- **Method:** `GET (Server-Sent Events)`
- **Endpoint:** `/notifications/connect`
- **설명:** 실시간 알림을 받기 위한 SSE 연결
- **인증:** JWT 필수
- **Response:** SSE Stream
- **파일 위치:** `src/domain/notifications/notifications.controller.ts:35`

### 4.2 읽지 않은 알림 개수 조회
- **Method:** `GET`
- **Endpoint:** `/notifications/count`
- **설명:** 현재 사용자의 읽지 않은 알림 개수 조회
- **인증:** JWT 필수
- **Response:** `200 OK`
  ```json
  {
    "count": 5
  }
  ```
- **파일 위치:** `src/domain/notifications/notifications.controller.ts:63`

### 4.3 알림 목록 조회
- **Method:** `GET`
- **Endpoint:** `/notifications`
- **설명:** 알림 목록 조회 (페이지네이션 지원)
- **인증:** JWT 필수
- **Query Parameters:**
  - `page`: number (optional)
  - `limit`: number (optional)
- **Response:** `200 OK`
- **파일 위치:** `src/domain/notifications/notifications.controller.ts:72`

### 4.4 알림 읽음 처리
- **Method:** `PATCH`
- **Endpoint:** `/notifications/:id/read`
- **설명:** 특정 알림을 읽음 상태로 변경
- **인증:** JWT 필수
- **Response:** `200 OK`
- **파일 위치:** `src/domain/notifications/notifications.controller.ts:86`

---

## 5. Profile (프로필)

**Base URL:** `/profile`

### 5.1 내 프로필 조회
- **Method:** `GET`
- **Endpoint:** `/profile/my`
- **설명:** 현재 로그인한 사용자의 프로필 조회
- **인증:** JWT 필수
- **Response:** `200 OK`
- **파일 위치:** `src/domain/profile/profile.controller.ts:41`

### 5.2 내 프로필 및 userId 조회
- **Method:** `GET`
- **Endpoint:** `/profile/my/info`
- **설명:** 전역 상태 관리를 위한 프로필 및 userId 조회
- **인증:** JWT 필수
- **Response:** `200 OK`
  ```json
  {
    "userId": "string",
    "profile": { ... }
  }
  ```
- **파일 위치:** `src/domain/profile/profile.controller.ts:54`

### 5.3 모든 프로필 조회
- **Method:** `GET`
- **Endpoint:** `/profile`
- **설명:** 모든 사용자의 프로필 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/profile/profile.controller.ts:66`

### 5.4 프로필 ID로 조회
- **Method:** `GET`
- **Endpoint:** `/profile/:id`
- **설명:** 특정 프로필 ID로 프로필 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/profile/profile.controller.ts:72`

### 5.5 User ID로 프로필 조회
- **Method:** `GET`
- **Endpoint:** `/profile/user/:userId`
- **설명:** userId로 프로필 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/profile/profile.controller.ts:78`

### 5.6 프로필 업데이트
- **Method:** `PATCH`
- **Endpoint:** `/profile/my`
- **설명:** 내 프로필 정보 수정
- **인증:** JWT 필수
- **Response:** `200 OK`
- **파일 위치:** `src/domain/profile/profile.controller.ts:84`

---

## 6. Users (사용자)

**Base URL:** `/users`

### 6.1 사용자 생성
- **Method:** `POST`
- **Endpoint:** `/users`
- **설명:** 새로운 사용자 생성
- **인증:** 불필요
- **Response:** `201 Created`
- **파일 위치:** `src/domain/users/users.controller.ts:29`

### 6.2 모든 사용자 조회
- **Method:** `GET`
- **Endpoint:** `/users`
- **설명:** 모든 사용자 목록 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:34`

### 6.3 사용자 조회
- **Method:** `GET`
- **Endpoint:** `/users/:id`
- **설명:** 특정 사용자 상세 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:39`

### 6.4 사용자 정보 업데이트
- **Method:** `PATCH`
- **Endpoint:** `/users/:id`
- **설명:** 사용자 정보 수정
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:44`

### 6.5 사용자 삭제
- **Method:** `DELETE`
- **Endpoint:** `/users/:id`
- **설명:** 사용자 삭제
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:49`

### 6.6 사용자 프로필 조회
- **Method:** `GET`
- **Endpoint:** `/users/:userId/profile`
- **설명:** 특정 사용자의 프로필 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:54`

### 6.7 사용자 게시글 목록 조회
- **Method:** `GET`
- **Endpoint:** `/users/:userId/posts`
- **설명:** 특정 사용자가 작성한 게시글 목록 조회
- **인증:** 불필요
- **Query Parameters:**
  - `page`: number (optional)
  - `limit`: number (optional)
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:59`

### 6.8 사용자 참여 목록 조회
- **Method:** `GET`
- **Endpoint:** `/users/:userId/participations`
- **설명:** 특정 사용자가 참여한 게시글 목록 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/users/users.controller.ts:67`

---

## 7. Post (게시글)

**Base URL:** `/posts`

### 7.1 게시글 생성
- **Method:** `POST`
- **Endpoint:** `/posts`
- **설명:** 새로운 게시글 작성
- **인증:** JWT 필수
- **Response:** `201 Created`
- **파일 위치:** `src/domain/post/post.controller.ts:29`

### 7.2 모든 게시글 조회
- **Method:** `GET`
- **Endpoint:** `/posts`
- **설명:** 모든 게시글 목록 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post/post.controller.ts:40`

### 7.3 게시글 검색
- **Method:** `GET`
- **Endpoint:** `/posts/search`
- **설명:** 쿼리 파라미터를 이용한 게시글 검색
- **인증:** 불필요
- **Query Parameters:**
  - `keyword`: string (optional)
  - `category`: string (optional)
  - `location`: string (optional)
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post/post.controller.ts:46`

### 7.4 사용자별 게시글 조회
- **Method:** `GET`
- **Endpoint:** `/posts/user/:userId`
- **설명:** 특정 사용자가 작성한 게시글 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post/post.controller.ts:51`

### 7.5 게시글 상세 조회
- **Method:** `GET`
- **Endpoint:** `/posts/:id`
- **설명:** 특정 게시글의 상세 정보 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post/post.controller.ts:60`

### 7.6 워크스페이스 멤버 조회
- **Method:** `GET`
- **Endpoint:** `/posts/workspace/:workspaceId/members`
- **설명:** 게시글 작성자와 승인된 참여자 목록 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post/post.controller.ts:68`

### 7.7 게시글 수정
- **Method:** `PATCH`
- **Endpoint:** `/posts/:id`
- **설명:** 게시글 정보 수정 (작성자만 가능)
- **인증:** JWT 필수
- **Response:** `200 OK`
- **파일 위치:** `src/domain/post/post.controller.ts:77`

### 7.8 게시글 삭제
- **Method:** `DELETE`
- **Endpoint:** `/posts/:id`
- **설명:** 게시글 삭제 (작성자만 가능)
- **인증:** JWT 필수
- **Response:** `200 OK`
  ```json
  {
    "message": "성공적으로 삭제되었습니다"
  }
  ```
- **파일 위치:** `src/domain/post/post.controller.ts:89`

### 7.9 동행 신청 취소
- **Method:** `DELETE`
- **Endpoint:** `/posts/:postId/participations/:participationId`
- **설명:** 본인의 동행 신청 취소
- **인증:** JWT 필수
- **Response:** `200 OK`
  ```json
  {
    "message": "동행 신청이 성공적으로 취소되었습니다."
  }
  ```
- **파일 위치:** `src/domain/post/post.controller.ts:103`

---

## 8. Matching (매칭)

**Base URL:** `/matching`

### 8.1 매칭 검색
- **Method:** `POST`
- **Endpoint:** `/matching/search`
- **설명:** AI 기반 매칭 검색
- **인증:** JWT 필수
- **Request Body:**
  ```json
  {
    "preferences": { ... }
  }
  ```
- **Response:** `200 OK`
- **파일 위치:** `src/domain/matching/matching.controller.ts:23`

### 8.2 매칭 프로필 임베딩
- **Method:** `POST`
- **Endpoint:** `/matching/profile/embedding`
- **설명:** 매칭을 위한 프로필 임베딩 생성
- **인증:** JWT 필수
- **Response:** `200 OK`
- **파일 위치:** `src/domain/matching/matching.controller.ts:33`

---

## 9. Place (장소)

**Base URL:** `/places`

### 9.1 경계 내 장소 조회
- **Method:** `GET`
- **Endpoint:** `/places`
- **설명:** 지도 경계 내의 장소 목록 조회
- **인증:** 불필요
- **Query Parameters:**
  - `minLat`: number
  - `maxLat`: number
  - `minLng`: number
  - `maxLng`: number
- **Response:** `200 OK`
- **파일 위치:** `src/domain/place/place.controller.ts:10`

### 9.2 장소 상세 조회
- **Method:** `GET`
- **Endpoint:** `/places/:id`
- **설명:** 특정 장소의 상세 정보 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/place/place.controller.ts:17`

---

## 10. Review (리뷰)

**Base URL:** `/reviews`

### 10.1 사용자가 받은 리뷰 조회
- **Method:** `GET`
- **Endpoint:** `/reviews/user/:userId`
- **설명:** 특정 사용자가 받은 모든 리뷰 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/review/review.controller.ts:19`

### 10.2 리뷰 수정
- **Method:** `PATCH`
- **Endpoint:** `/reviews/:reviewId`
- **설명:** 리뷰 내용 수정 (작성자만 가능)
- **인증:** JWT 필수
- **Response:** `200 OK`
- **파일 위치:** `src/domain/review/review.controller.ts:25`

---

## 11. Workspace (워크스페이스)

**Base URL:** `/workspace`

### 11.1 워크스페이스 생성
- **Method:** `POST`
- **Endpoint:** `/workspace`
- **설명:** 새로운 워크스페이스 생성
- **인증:** 불필요
- **Response:** `201 Created`
- **파일 위치:** `src/domain/workspace/workspace.controller.ts:27`

### 11.2 워크스페이스 리뷰 생성
- **Method:** `POST`
- **Endpoint:** `/workspace/:workspaceId/reviews`
- **설명:** 워크스페이스 내에서 여러 사용자에 대한 리뷰 생성
- **인증:** JWT 필수
- **Request Body:**
  ```json
  [
    {
      "receiverId": "string",
      "rating": 5,
      "comment": "string"
    }
  ]
  ```
- **Response:** `201 Created`
- **파일 위치:** `src/domain/workspace/workspace.controller.ts:33`

### 11.3 POI 최적화 브로드캐스트
- **Method:** `POST`
- **Endpoint:** `/workspace/poi/optimize`
- **설명:** Python AI 서버로부터 POI 최적화 결과를 받아 WebSocket으로 브로드캐스트
- **인증:** 불필요
- **Request Body:**
  ```json
  {
    "workspaceId": "string",
    "planDayId": "string",
    "poiIds": ["string"],
    "apiKey": "string"
  }
  ```
- **Response:** `200 OK`
  ```json
  {
    "success": true,
    "message": "POI order optimized and broadcasted successfully"
  }
  ```
- **파일 위치:** `src/domain/workspace/workspace.controller.ts:47`

### 11.4 워크스페이스 상세 조회
- **Method:** `GET`
- **Endpoint:** `/workspace/:id`
- **설명:** 특정 워크스페이스의 상세 정보 조회
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/workspace/workspace.controller.ts:62`

### 11.5 워크스페이스 삭제
- **Method:** `DELETE`
- **Endpoint:** `/workspace/:id`
- **설명:** 워크스페이스 삭제
- **인증:** 불필요
- **Response:** `200 OK`
- **파일 위치:** `src/domain/workspace/workspace.controller.ts:67`

---

## 요약

### 통계
- **총 도메인 수:** 11개
- **총 API 엔드포인트 수:** 55개
- **JWT 인증 필요:** 18개
- **인증 불필요:** 37개

### 주요 기능
- **실시간 통신:** Server-Sent Events (SSE) - 알림 구독
- **파일 관리:** S3 Presigned URL 방식
- **WebSocket:** POI 최적화 브로드캐스트
- **AI 기반:** 매칭 시스템 (임베딩)

### 인증 방식
- JWT (JSON Web Token) 기반 인증
- 쿠키를 통한 토큰 저장 (httpOnly, sameSite: lax)
- AccessToken 유효기간: 1시간
